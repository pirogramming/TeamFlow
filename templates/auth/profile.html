{% extends "base.html" %}
{% load static %}

{% block title %}내 프로필{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/pages/auth/profile.css' %}">
{% endblock %}

{% block content %}
<!-- CSRF 토큰 (JavaScript에서 사용) -->
{% csrf_token %}

<div class="page-container">
    <!-- 헤더 -->
    <div class="profile-header">
        <div class="page-title-group">
            <h1 class="page-title">내 프로필</h1>
            <p class="page-subtitle">개인 정보를 확인하고 수정할 수 있습니다</p>
        </div>
    </div>

    <!-- 프로필 정보 섹션 -->
    <div class="profile-info-section">
        <div class="profile-info-card">
            <div class="card-header">
                <h3 class="card-title">프로필 정보</h3>
                <p class="card-subtitle">기본 정보를 확인하세요</p>
            </div>
                         <div class="card-content">
                 <div class="profile-display">
                     <div class="profile-avatar">
                         <svg viewBox="0 0 24 24" fill="currentColor" class="avatar-icon">
                             <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
                         </svg>
                     </div>
                     <div class="user-info">
                         <h2 class="user-display-name" id="display-name">사용자</h2>
                         <p class="user-email" id="user-email">{{ user.email }}</p>
                     </div>
                     <button
                         type="button"
                         class="btn btn-danger"
                         id="logout-btn"
                     >
                         <svg class="btn-icon" fill="currentColor" viewBox="0 0 24 24">
                             <path d="M17 7l-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.59L17 17l5-5-5-5zM3 5h8v2H5v10h6v2H3z"/>
                         </svg>
                         로그아웃
                     </button>
                 </div>
             </div>
        </div>
    </div>

    <!-- 로딩 상태 -->
    <div class="profile-loading" id="profile-loading">
        <div class="loading-spinner"></div>
        <span>프로필 정보를 불러오는 중...</span>
    </div>

    <!-- 상태 메시지 -->
    <div class="profile-message" id="profile-message"></div>

    <!-- 개인정보 수정과 활동 통계를 한 행에 배치 -->
    <div class="profile-main-section">
        <!-- 프로필 폼 섹션 -->
        <div class="profile-form-section">
            <div class="profile-form-card">
                <div class="card-header">
                    <h3 class="card-title">개인 정보 수정</h3>
                    <p class="card-subtitle">아래 정보를 수정할 수 있습니다</p>
                </div>
                <div class="card-content">
                    <form id="profile-form" class="profile-form" novalidate>
                        {% csrf_token %}

                        <!-- 이메일 (읽기 전용) -->
                        <div class="form-group">
                            <label for="email" class="form-label">이메일</label>
                            <input
                                type="email"
                                id="email"
                                name="email"
                                class="form-input"
                                value="{{ user.email }}"
                                readonly
                                disabled
                            />
                        </div>

                        <!-- 이름 입력 -->
                        <div class="form-group">
                            <label for="first_name" class="form-label required">이름</label>
                            <input
                                type="text"
                                id="first_name"
                                name="first_name"
                                class="form-input"
                                placeholder="이름을 입력해주세요"
                                required
                                autocomplete="given-name"
                            />
                        </div>

                        <!-- 전공 입력 -->
                        <div class="form-group">
                            <label for="major" class="form-label required">전공</label>
                            <input
                                type="text"
                                id="major"
                                name="major"
                                class="form-input"
                                placeholder="전공을 입력해주세요 (예: 컴퓨터공학과, 경영학과)"
                                required
                                maxlength="100"
                                autocomplete="organization-title"
                            />
                        </div>

                        <!-- 세부전공 입력 -->
                        <div class="form-group">
                            <label for="specialization" class="form-label">세부전공 (선택)</label>
                            <input
                                type="text"
                                id="specialization"
                                name="specialization"
                                class="form-input"
                                placeholder="세부전공이나 특기사항을 입력해주세요"
                                maxlength="100"
                                autocomplete="organization"
                            />
                        </div>

                        <!-- 액션 버튼 -->
                        <div class="form-actions">
                            <button
                                type="button"
                                class="btn btn-secondary"
                                id="restore-btn"
                                disabled
                            >
                                <svg class="btn-icon" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0zm9-7a7 7 0 0 0-7 7h2a5 5 0 0 1 5-5v-2zm0 14a7 7 0 0 0 7-7h-2a5 5 0 0 1-5 5v2z"/>
                                </svg>
                                복구하기
                            </button>

                            <button
                                type="submit"
                                class="btn btn-primary"
                                id="save-btn"
                                disabled
                            >
                                <svg class="btn-icon" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
                                </svg>
                                저장하기
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- 통계 섹션 -->
        <div class="profile-stats-section">
            <div class="stats-card">
                <div class="card-header">
                    <h3 class="card-title">활동 통계</h3>
                    <p class="card-subtitle">팀플로우에서의 활동 현황</p>
                </div>
                <div class="card-content">
                    <div class="stats-grid">
                        <div class="stat-item">
                            <div class="stat-number" id="join-date">-</div>
                            <div class="stat-label">가입일</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number" id="teams-count">-</div>
                            <div class="stat-label">참여 팀</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number" id="tasks-count">-</div>
                            <div class="stat-label">완료 작업</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/pages/auth/profile.js' %}"></script>
{% endblock %}
