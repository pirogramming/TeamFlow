{% extends "base.html" %}
{% load static %}

{% block title %}내 프로필{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/pages/auth/profile.css' %}">
{% endblock %}

{% block content %}
<!-- CSRF 토큰 (JavaScript에서 사용) -->
{% csrf_token %}

<div class="page-container">
    <div class="profile-page-container">
        <div class="profile-container">
            <!-- 헤더 섹션 -->
            <div class="profile-header">
                <h1 class="profile-title">내 프로필</h1>
                <p class="profile-subtitle">개인 정보를 확인하고 수정할 수 있습니다</p>
            </div>

            <!-- 프로필 카드 -->
            <div class="profile-card">
                <!-- 프로필 정보 섹션 -->
                <div class="profile-info-section">
                    <div class="profile-avatar">
                        <svg fill="currentColor" viewBox="0 0 24 24">
                            <path d="M12 2c2.21 0 4 1.79 4 4 0 2.21-1.79 4-4 4s-4-1.79-4-4c0-2.21 1.79-4 4-4zm0 14c2.67 0 8 1.34 8 4v2H4v-2c0-2.66 5.33-4 8-4z"/>
                        </svg>
                    </div>
                    <h2 class="user-display-name" id="display-name">사용자</h2>
                    <p class="user-email" id="user-email">{{ user.email }}</p>
                </div>

                <!-- 로딩 상태 -->
                <div class="profile-loading" id="profile-loading">
                    <div class="loading-spinner"></div>
                    <span>프로필 정보를 불러오는 중...</span>
                </div>

                <!-- 상태 메시지 -->
                <div class="profile-message" id="profile-message"></div>

                <!-- 프로필 폼 섹션 -->
                <div class="profile-form-section">
                    <div class="profile-form-header">
                        <h3 class="form-section-title">개인 정보</h3>
                        <p class="form-section-description">아래 정보를 수정할 수 있습니다</p>
                    </div>

                    <form id="profile-form" class="profile-form" novalidate>
                        {% csrf_token %}

                        <!-- 이메일 (읽기 전용) -->
                        <div class="profile-form-group">
                            <label for="email" class="profile-form-label">이메일</label>
                            <input
                                type="email"
                                id="email"
                                name="email"
                                class="profile-form-input"
                                value="{{ user.email }}"
                                readonly
                                disabled
                            />
                        </div>

                        <!-- 이름 입력 -->
                        <div class="profile-form-group">
                            <label for="first_name" class="profile-form-label required">이름</label>
                            <input
                                type="text"
                                id="first_name"
                                name="first_name"
                                class="profile-form-input"
                                placeholder="이름을 입력해주세요"
                                required
                                autocomplete="given-name"
                            />
                        </div>

                        <!-- 전공 입력 -->
                        <div class="profile-form-group">
                            <label for="major" class="profile-form-label required">전공</label>
                            <input
                                type="text"
                                id="major"
                                name="major"
                                class="profile-form-input"
                                placeholder="전공을 입력해주세요 (예: 컴퓨터공학과, 경영학과)"
                                required
                                maxlength="100"
                                autocomplete="organization-title"
                            />
                        </div>

                        <!-- 세부전공 입력 -->
                        <div class="profile-form-group">
                            <label for="specialization" class="profile-form-label">세부전공 (선택)</label>
                            <input
                                type="text"
                                id="specialization"
                                name="specialization"
                                class="profile-form-input"
                                placeholder="세부전공이나 특기사항을 입력해주세요"
                                maxlength="100"
                                autocomplete="organization"
                            />
                        </div>

                        <!-- 액션 버튼 -->
                        <div class="profile-actions">
                            <button
                                type="button"
                                class="profile-btn profile-btn-secondary"
                                id="cancel-btn"
                            >
                                <svg class="profile-btn-icon" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                                </svg>
                                취소
                            </button>
                            <button
                                type="submit"
                                class="profile-btn profile-btn-primary"
                                id="save-btn"
                            >
                                <svg class="profile-btn-icon" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
                                </svg>
                                저장하기
                            </button>
                        </div>
                    </form>
                </div>

                <!-- 통계 섹션 (선택적) -->
                <div class="profile-stats">
                    <div class="profile-stat">
                        <div class="stat-number" id="teams-count">-</div>
                        <div class="stat-label">참여 팀</div>
                    </div>
                    <div class="profile-stat">
                        <div class="stat-number" id="tasks-count">-</div>
                        <div class="stat-label">완료 작업</div>
                    </div>
                    <div class="profile-stat">
                        <div class="stat-number" id="join-date">-</div>
                        <div class="stat-label">가입일</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/pages/auth/profile.js' %}"></script>
{% endblock %}
