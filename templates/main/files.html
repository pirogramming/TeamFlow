{% extends "base.html" %}
{% load static %}

{% block title %}자료실 - TeamFlow{% endblock %}

{% block extra_css %}
  <link rel="stylesheet" href="{% static 'css/pages/main/files.css' %}" />
{% endblock %}

{% block content %}
<script id="team-data" type="application/json">
  {
    "teamId": "{{ team.id }}"
  }
</script>

<div class="page-container">
  <div class="view-header">
    <h1>자료실</h1>
    <!-- ✨ 이 버튼을 추가했습니다. -->
    {% if files %}
    <a href="{% url 'files_batch_download' team.id %}" class="btn">전체 다운로드</a>
    {% endif %}
  </div>

  <!-- 파일 업로드 폼 -->
  <div class="upload-container">
    <h3>새 자료 업로드</h3>
    <form id="file-upload-form">
      {% csrf_token %}
      <input type="file" id="file-input" name="file" required>
      <button type="submit" class="btn btn-primary">업로드</button>
    </form>
  </div>

  <!-- 파일 목록 -->
  <div class="file-list-container">
    <h3>파일 목록</h3>
    <ul id="file-list">
      {% for file in files %}
        <li data-file-id="{{ file.id }}">
          <span class="file-name">{{ file.filename }}</span>
          <span class="uploader-info">(by {{ file.uploader.username }})</span>
          <div class="file-actions">
            <a href="{% url 'file_download' file.id %}" class="btn btn-download">다운로드</a>
            <button class="delete-btn">삭제</button>
          </div>
        </li>
      {% empty %}
        <li id="no-files-message">업로드된 파일이 없습니다.</li>
      {% endfor %}
    </ul>
  </div>
</div>
{% endblock %}

{% block extra_js %}
  <script src="{% static 'js/pages/main/files.js' %}"></script>
{% endblock %}